# Definición del bloque de eventos, requerido pero no utilizado en esta configuración.
events {}

# Inicio del bloque de configuración HTTP.
http {
    # Configuración del primer servidor.
    server {
        # Escucha en el puerto 80.
        listen 80;
        # Define el nombre del servidor para esta configuración.
        server_name admin.localhost;

        # Configuración de la ubicación raíz.
        location / {
            # Redirige las solicitudes a un servicio llamado "phpmyadmin".
            proxy_pass http://phpmyadmin;
            # Pasa la cabecera del host original.
            proxy_set_header Host $host;
            # Pasa la dirección IP real del cliente.
            proxy_set_header X-Real-IP $remote_addr;
            # Pasa las direcciones IP en cadena si hay proxies intermedios.
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            # Pasa el esquema de protocolo (http o https).
            proxy_set_header X-Forwarded-Proto $scheme;
        }
    }

    # Configuración del segundo servidor.
    server {
        # Escucha en el puerto 81.
        listen 81;
        # Define el nombre del servidor para esta configuración.
        server_name app.locahost;

        # Configuración de la ubicación raíz.
        location / {
            # Redirige las solicitudes a un servicio llamado "app" en el puerto 3000.
            proxy_pass http://app:3000;
            # Pasa la cabecera del host original.
            proxy_set_header Host $host;
            # Pasa la dirección IP real del cliente.
            proxy_set_header X-Real-IP $remote_addr;
            # Pasa las direcciones IP en cadena si hay proxies intermedios.
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            # Pasa el esquema de protocolo (http o https).
            proxy_set_header X-Forwarded-Proto $scheme;
        }
    }
}